<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html; charset=windows-1252" http-equiv="content-type">
    <title>AvNav Beschreibung</title>
  </head>
  <body>
    <h2 class="western">AvNav - Navigation per WebApp</h2>
    <p>Stand 2014/09/01</p>
    <p>Ein Hinweis vorweg:</p>
    <p>I<i><b>ch kann keine Garantie für die Funktion der App übernehmen,
          insbesondere die Nutzung zu Navigationszwecken geschieht auf eigenes
          Risiko. In jedem Falle empfehle ich einen intensiven Test der
          Genauigkeit der Darstellung und des verwendeten Kartenmaterials.</b></i></p>
    <p>Die wesentlichen Fähigkeiten:</p>
    <ul>
      <li>
        <p>Darstellung der Kartendaten (blattschnittfrei je Satz), mit den
          enstprechenden Funktionen (Zoom, move,...)</p>
      </li>
      <li>
        <p>Dartstellung der aktuellen Schiffsposition mit Kurs, Geschwindigkeit
          (mit Lock der Karte auf Schiffsposition)</p>
      </li>
      <li>
        <p>Darstellung des aktuellen Tracks (der Track wird auch in einer gpx
          Datei gespeichert)</p>
      </li>
      <li>
        <p>Setzen eines Wegepunktes, Anzeige von Richtung,Entfernung,ETA</p>
      </li>
      <li>
        <p>AIS Anzeige mit Darstellung in der Karte, AIS Target am nächsten zum
          Schiff, Warnung bei CPA &lt; 500m, CPA,TCPA, AIS Infos</p>
      </li>
      <li>
        <p>Erzeugen einer Route (mit Editiermöglichkeit zu jedem Zeitpunkt)</p>
      </li>
      <li>Mehrere Displays an einem Server</li>
    </ul>
    <p>Im Folgenden beschreibe ich kurz die Bedienung der aktuellen Version,
      danach einige technische Details.</p>
    <h3 class="western">Die Bedienung</h3>
    <p>Nach dem Aufruf der Start-Url landet man auf der Einstigesseite.</p>
    <p><img src="mainpage.png" name="Grafik3" border="0" width="600"> </p>
    <p>Im Hauptbereich der Seite befindet sich die Liste der vom Server
      gefundenen Kartensätze (gemf files unter /data/avnav/charts). Durch
      Anklicken gelang man zur Navigationsseite mit dem enstprechenden
      Kartensatz.</p>
    <p>Wie auf allen Seiten befindet sich am rechten Rand eine Button-Leiste.
      Von hier aus erreich man eine Status-Seite des Servers und die Hilfe.</p>
    <h4 class="western">Die Navigationsseite</h4>
    <p><br clear="RIGHT">
      Dieses Bild zeigt einen gesetzten Marker (locked) – das Boot ist
      allaerdings noch nicht auf Kurs (daher noch keine ETA).</p>
    <p><img src="navi-routing-wp-ais.png" name="Grafik4" border="0" height="400">
    </p>
    <p>Dies ist die Hauptansicht. In der Mitte befindet sich die Kartenansicht
      mit der Schiffsposition (roter Pfeil). Die gelben und grünen Dreiecke mit
      Pfeilspitzen sind empfangene AIS Ziele in der Nähe (10nm) mit ihrem
      aktuellen Kurs sowie Name oder MMSI. Die organgefarbene Linie zeigt zum
      aktiven Wegepunkt. Die gepunktete Linie zeigt den Kurs vom Start der
      Navigation zum Wegepunkt (Sollkurs). Die Karte kann mit den normalen
      Gesten verschoben oder gezoomt werden, zum zoomen können auch die Buttons
      +/- auf der rechten Leiste benutzt werden.Wenn (wie im Bild) der
      Schiff-Button einen grünen Rand hat ("Schiff lock"), ist die Karten-Mitte
      auf die Schiffsposition fixiert und springt immer wieder dahin zurück.</p>
    <p>Links befindet sich die Darstellung des nächsten AIS Zieles (geringste
      momentane Entfernung). Dieses färbt sich rot, wenn eine CPA von 500m
      unterschritten wird. Gelb bedeuted, dass nicht das nächste Ziel sondern
      ein separat ausgewähltes Ziel (siehe unten AIS) angezeigt wird. Ein Klick
      auf diese Fläche oder ein AIS Ziel auf der Karte führt auf die AIS Info
      Liste (s.u.).</p>
    <p>Im unteren Bereich befindet sich die Anzeige der wichtigsten
      Navigationsdaten. Links die Daten des aktuellen Wegepunktes (Marker):</p>
    <ul>
      <li>
        <p>Position</p>
      </li>
      <li>
        <p>ETA</p>
      </li>
      <li>
        <p>Kurs</p>
      </li>
      <li>
        <p>Distanz (nm)</p>
      </li>
    </ul>
    <p>Danach folgen die Schiffsdaten:</p>
    <ul>
      <li>
        <p>Kurs</p>
      </li>
      <li>
        <p>Geschwindigkeit (kn)</p>
      </li>
      <li>
        <p>Position</p>
      </li>
      <li>
        <p>aktuelle (lokale) Zeit vom GPS</p>
      </li>
      <li>
        <p>GPS Indikator: grün – GPS Daten vorhanden, rot: keine Daten </p>
      </li>
    </ul>
    <p>Ein Klick auf die linke bzw. rechte Seite der Leiste zentriert die Karte
      jeweils auf den Wegepunkt bzw. die Bootsposition. Ein Klick auf die
      GPS-Position führt zur GPS-Datenanzeige.</p>
    <p>Auf der rechten Seite befindet sich eine Button-Leiste:</p>
    <table border="1" cellpadding="4" cellspacing="4" width="90%">
      <colgroup><col width="89"> <col width="641"> </colgroup>
      <tbody>
        <tr valign="TOP">
          <th width="89">
            <p align="CENTER">Button </p>
          </th>
          <th width="641">
            <p>Funktion </p>
          </th>
        </tr>
        <tr valign="TOP">
          <td width="89">
            <p align="CENTER">+</p>
          </td>
          <td width="641">
            <p>Zoom in</p>
          </td>
        </tr>
        <tr valign="TOP">
          <td width="89">
            <p align="CENTER">-</p>
          </td>
          <td width="641">
            <p>Zoom out</p>
          </td>
        </tr>
        <tr valign="TOP">
          <td width="89">
            <p align="CENTER"><img src="../viewer/images/Sail-Boat-40.png" name="Grafik7"
                align="LEFT" border="0" height="40"><br clear="LEFT">
              <br>
            </p>
          </td>
          <td width="641">
            <p>Boat „lock“. Wenn dieser Lock eingeschaltet ist (grüner Rand)
              wird die Karte immer auf die Bootsposition zentriert.</p>
          </td>
        </tr>
        <tr valign="TOP">
          <td width="89">
            <p align="CENTER"><img src="../viewer/images/Marker1.png" name="Grafik6"
                align="LEFT" border="0" height="40"> <br>
            </p>
          </td>
          <td width="641">
            <p>Marker lock. Wenn der Lock ausgeschaltet ist, springt der Marker
              in die Mitte der angezeigten Karte. In diesem Zustand kann man die
              Karte verschieben bis sich der Marker an der gewünschten Stelle
              (=Wegepunkt) befindet. Mit Klick auf den Marker button erscheint
              ein grüner Rand und die Kurslinie zum Marker wird angezeigt. Der
              Marker bleibt auf dieser Position.</p>
          </td>
        </tr>
        <tr>
          <td><img alt="" src="../viewer/images/nadel-2.png" height="40"><br>
          </td>
          <td>"Course Up" Wenn eingeschaltet, wird die Karte so gedreht, dass
            die Vorausrichtung oben ist. Sonst "North Up".<br>
          </td>
        </tr>
        <tr>
          <td><img alt="" src="../viewer/images/RoutingButton40.png"><br>
          </td>
          <td>Routing mode. Wechselt zur Route Edit Seite</td>
        </tr>
        <tr valign="TOP">
          <td width="89">
            <p align="CENTER"><img src="../viewer/images/Cancel40.png" name="Grafik8"
                align="LEFT" border="0" height="40"><br clear="LEFT">
              <br>
            </p>
          </td>
          <td width="641">
            <p>Zurück zur Einstiegsseite. Die aktuelle Kartenposition, die
              Marker-Position und der aktuelle zoom bleiben erhalten wenn auf
              einen anderen Kartensatz gewechselt wird.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p> </p>
    <p>Eine typische Bedienfolge:</p>
    <p>Waypoint setzen:</p>
    <p>unlock Boot-&gt;unlock Marker-&gt;Karte verschieben bis Marker auf
      gewünschter Pos (Zoom nutzen)-&gt;lock Marker-&gt;lock Boot </p>
    <p>Wenn man einen Wegepunkt aktiv hat (Marker Button grün) und die Karte
      nicht auf das Schiff "gelockt" ist (Schiffsbutton nicht grün), wird beim
      Bewegen der Karte ein Kreuz im Zentrum gezeigt und unten erscheint eine
      Anzeig des aktuellen Abstandes vom Marker bzw. Schiff zum
      Kartenmittelpunkt. Damit kann man einfache Peilungen machen - Mittelpunkt
      auf Peilziel verschieben und Peilung ablesen.</p>
    <p><img src="center-measure.PNG" alt="center" width="600"></p>
    <p>Die Anzeige verschwindet nach 45s automatisch, wenn die Karte nicht
      bewegt wird, alternativ durch Klick auf die Daten.</p>
    <p><br>
    </p>
    <h4>Die Routingseite</h4>
    <img alt="" src="navi-route-add.png" height="400">
    <p>Auf der Routing Seite kann man eine Route bearbeiten bzw.
      editieren.&nbsp;</p>
    <p>Zu jeder Zeit gibt es einen aktiven Wegepunkt (rot dargestellt, links in
      der Anzeige rot mnarkiert und oben in der Wegepunkt-Box angezeigt). Die
      meisten Aktionen bezihen sich auf diesen Wegepunkt. Er kann durch
      Anklicken links, durch die Pfeiltasten oebn oder durch anklicken auf der
      Karte geändert werden.</p>
    <p>Neben den Standard buttons der Navigationsseite wird eine zusätzliche
      Leiste mit routing buttons eingeblendet:</p>
    <table style="width: 100%" border="1">
      <tbody>
        <tr>
          <td style="width: 59.42px;"><img alt="" src="../viewer/images/wpplus40.png"><br>
          </td>
          <td style="width: 1427.58px;">Setzen eines neuen Wegepunktes in der
            Route. Der Kartenmittelpunkt (+) wird zu einem neuen Wegepunkt. Der
            neue Wegepunkt wird nach dem aktiven Wegepunkt in die Route
            eingefügt. Alle Routen-Daten werden neu berechnet.</td>
        </tr>
        <tr>
          <td><img alt="" src="../viewer/images/wpminus40.png"><br>
          </td>
          <td>Entfernen des aktuellen Wegepunktes aus der Route.</td>
        </tr>
        <tr>
          <td><img alt="" src="../viewer/images/wpcenter60.png" height="40"><br>
          </td>
          <td>Setzen des aktuellen Wegepunktes auf den Kartenmittelpunkt (+)<br>
          </td>
        </tr>
        <tr>
          <td><img alt="" src="../viewer/images/wpgoto60.png" height="40"><br>
          </td>
          <td>Starten der Route. Die Route wird (beginnend mit dem aktuellen
            Wegepunkt) aktiviert (und der Edit-Modus wird verlassen)<br>
          </td>
        </tr>
        <tr>
          <td><img alt="" src="../viewer/images/trash32.png"><br>
          </td>
          <td>Löschen der aktuellen Route (alle Wegepunkte werden gelöscht)<br>
          </td>
        </tr>
      </tbody>
    </table>
    <p>Ein Klick auf den <img alt="" src="../viewer/images/RoutingButton40.png"
        height="20">Button verläßt den Editier-Modus ohne dass die Route aktiv
      wird.</p>
    <p>Auf der linken Seite werden die Wegepunkte der aktuellen Route angezeigt.
      Dazu jeweils die Kurse und Distanzen für die Abschnitte. Im oberen Teil
      die Gesamtlänge der Route sowie die Gesamtstrecke sowie die ETA. Durch
      Anklicken kann man einen Wegepunkt aktivieren.</p>
    <p>Im oberen "Waypoint" Feld (nur sichtbar auf Mobilgeräten) kann man den
      Namen des Wegepunktes ändern und durch die Wegepunkte navigieren.</p>
    <p>Wenn eine Route aktiv ist, ändert sich das Navigationsdisplay und enthält
      die noch zurückzulegende Strecke sowie die ETA (links unten):</p>
    <img alt="" src="navi-route-active.png" height="400">
    <p>Der nächste Wegepunkt der Route wird der aktive.</p>
    <p>In diesem Modus erfolgt eine automatische Weiterschaltung zum nächsten
      Wegepunkt, wenn die folgenden Bedingungen erfüllt sind:</p>
    <ul>
      <li>Das Boot befindet sich im "Fangbereich" (default 200m -
        settings-&gt;route-&gt;approach)</li>
      <li>Die Entfernung zum Wegepunkt wird größer</li>
    </ul>
    Die Anzeige der Routen-Parameter wird rot und zeigt den Kurs zum nächsten WP
    an, wenn das Boot im "Fangbereich" ist:<br>
    <img alt="" src="navi-route-approach.png" height="400"><br>
    <p>Falls keine automatische Weiterschaltung erfolgt (z.B. weil man nicht
      dicht genug am WP ist), kann man kurz den Routen-Editor aktivieren, oben
      (-&gt;) zum nächsten WP schalten und diesen aktivieren (<img alt="" src="../viewer/images/wpgoto60.png"
        height="20">).</p>
    <h3>Die AIS Übersicht</h3>
    <p>Mit einem Klick auf die AIS Info gelangt man zur AIS Übersicht:</p>
    <p><img src="navi-ais.png" name="Grafik10" border="0" width="600"><br clear="RIGHT">
      Auf dieser Seite sieht man alle empfangenen AIS Ziele im Umkreis von ca.
      10nm zur Bootsposition (sortiert nach CPA). Mit Klick auf eine Zeile
      springt man zurück zur Karten-Anzeige mit dem gewählten AIS Ziel im
      Zentrum. Das gewählte Ziel erscheint auch im AIS Info Fenster (dieses
      färbt sich gelb). Ein Klick auf den grünen Pfeil schaltet wieder in den
      „Normalmodus“ - d.h. Anzeige des nächsten AIS Zieles.</p>
    <p>Mit dem zurück Button geht es unverändert zur Karten-Anzeige zurück.</p>
    <h3>Die GPS Seite</h3>
    <p>Über den Button (000) auf der Start-Seite oder einen Klick auf die
      Position (rechts unten) auf der Navi-Seite gelangt man zu einer Anzeige
      der GPS-Daten ohne Karte.</p>
    <img alt="" src="gps-display.png" height="400"><br>
    <br>
    Ein Klick auf die Anzeige des nächsten AIS-Zieles (rechts unten) führt zur
    AIS-Seite, ein Klick auf jede andere Stelle oder den Cancel-Button zurück
    zur Seite von der man kam.<br>
    <br>
    <h3> Die Settings Seite</h3>
    <br>
    Über den Button <img alt="" src="../viewer/images/spanner32.png" height="20">von
    der Startseite erreicht man die Einstellungs-Seite. Hier können verschiedene
    Parameter der Applikation eingestellt werden. Diese werden im Browser
    gespeichert, beziehen sich also auf das jeweilige Gerät.<br>
    Allgemein führt ein Klick auf <img alt="" src="../viewer/images/trash32.png"
      height="20">zum Rücksetzen auf Standard-Werte (einzelne Einstellung oder
    alle), Cancel verläßt die Seite und verwirft alle Änderungen.<br>
    <img alt="" src="settingspage.png" height="400"><br>
    <br>
    <h3>Die Status Seite</h3>
    Von der Startseite kann man noch eine Status-Seite erreichen – hier werden
    interne Status-Infos des Servers angezeigt.
    <p><img src="navi-status.png" name="Grafik11" border="0" width="600"><br clear="RIGHT">
      Wichtig ist hier insbesondere der Status der „Serial reader“ - dieser
      zeigt, ob sie NMEA Daten empfangen.</p>
    <h3>Der Nachtmodus</h3>
    <p>Um im Dunkeln nicht zu blenden, kann man auf einen Nachtmodus umstellen
      (button <img alt="" src="../viewer/images/Night60.png" height="20">auf
      der Startseite).</p>
    <img alt="" src="gps-display-night.png" height="400"> <br>
    <br>
    <h3> Connected Mode</h3>
    Der Button <img alt="" src="../viewer/images/plug32.png" height="20">auf
    der Startseite schaltet den connected mode. Wenn er aktiv ist (default) wird
    das Setzen eines Wegepunktes oder das Aktivieren einer Route zum Server
    übertragen, so dass das auf allen angeschlossenen Geräten aktiv wird.<br>
    Wenn vom non-connected zum connected mode gewechselt wird, werden die Daten
    vom Server übernommen (Wegepunkt und Route).<br>
    <br>
    <br>
    <h2 class="western">Lizenzen und verwendete Libraries</h2>
    <table border="1" cellpadding="4" cellspacing="4" width="90%">
      <colgroup><col width="85*"> <col width="85*"> <col width="85*"> </colgroup>
      <tbody>
        <tr valign="TOP">
          <th width="33%">
            <p>Library</p>
          </th>
          <th width="33%">
            <p>Link</p>
          </th>
          <th width="33%">
            <p>Lizenz</p>
          </th>
        </tr>
        <tr valign="TOP">
          <td width="33%">
            <p>OpenLayers 3 (3.1.1)</p>
          </td>
          <td width="33%">
            <p><a href="http://www.openlayers.org/">http://www.openlayers.org/</a></p>
          </td>
          <td width="33%"> <a href="https://tldrlegal.com/license/bsd-2-clause-license-%28freebsd%29">2-clause
              BSD licence</a></td>
        </tr>
        <tr valign="TOP">
          <td width="33%">
            <p>Jquery 1.9.1.</p>
          </td>
          <td width="33%">
            <p><a href="http://jquery.com/">http://jquery.com/</a></p>
          </td>
          <td width="33%"> <a href="http://opensource.org/licenses/MIT">MIT
              licence</a> </td>
        </tr>
        <tr valign="TOP">
          <td width="33%">
            <p>Tiler tools</p>
          </td>
          <td width="33%">
            <p><a href="https://code.google.com/p/tilers-tools/">https://code.google.com/p/tilers-tools/</a></p>
          </td>
          <td width="33%"> <a href="http://opensource.org/licenses/MIT">MIT
              licence</a> </td>
        </tr>
        <tr valign="TOP">
          <td width="33%">
            <p>Movable type</p>
          </td>
          <td width="33%">
            <p><a href="http://www.movable-type.co.uk/scripts/latlong.html">http://www.movable-type.co.uk/scripts/latlong.html</a></p>
          </td>
          <td width="33%"> <a href="http://opensource.org/licenses/MIT">MIT
              licence</a> </td>
        </tr>
        <tr valign="TOP">
          <td width="33%">
            <p>gpsd</p>
          </td>
          <td width="33%">
            <p><a href="http://www.catb.org/gpsd/">http://www.catb.org/gpsd/</a></p>
          </td>
          <td width="33%">
            <p><a href="http://ModifiedBSDLicence.html/">Modified BSD License</a></p>
          </td>
        </tr>
        <tr>
          <td>less 1.7.3</td>
          <td>
            <p><a href="http://lesscss.org/">http://lesscss.org/</a><a href="http://www.apache.org/licenses/LICENSE-2.0"><br>
              </a></p>
          </td>
          <td><a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2</a></td>
        </tr>
        <tr>
          <td>rangeslider</td>
          <td><a href="https://github.com/andreruffert/rangeslider.js">https://github.com/andreruffert/rangeslider.js</a></td>
          <td><a href="http://opensource.org/licenses/MIT">MIT licence</a></td>
        </tr>
        <tr>
          <td>JSColor</td>
          <td><a href="http://jscolor.com">http://jscolor.com</a></td>
          <td><a href="http://www.gnu.org/copyleft/lesser.html">LGPL</a></td>
        </tr>
        <tr>
          <td>Free Icons</td>
          <td><a href="http://www.tutorial9.net/downloads/108-mono-icons-huge-set-of-minimal-icons/">http://www.tutorial9.net/downloads/108-mono-icons-huge-set-of-minimal-icons/</a></td>
          <td>free, no attribution</td>
        </tr>
        <tr>
          <td>gpxpy</td>
          <td><a href="https://github.com/tkrajina/gpxpy">https://github.com/tkrajina/gpxpy</a></td>
          <td><a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2</a></td>
        </tr>
      </tbody>
    </table>
    <p><br>
      <br>
    </p>
    <p>Diese Software: MIT Licence</p>
    <div id="block-system-main" dir="LTR">
      <div id="node-66" dir="LTR">
        <h4 class="western">The MIT License (MIT)</h4>
        <p>Copyright (c) 2013 Andreas Vogel http://www.wellenvogel.de</p>
        <p>Permission is hereby granted, free of charge, to any person obtaining
          a copy<br>
          of this software and associated documentation files (the "Software"),
          to deal<br>
          in the Software without restriction, including without limitation the
          rights<br>
          to use, copy, modify, merge, publish, distribute, sublicense, and/or
          sell<br>
          copies of the Software, and to permit persons to whom the Software is<br>
          furnished to do so, subject to the following conditions:</p>
        <p>The above copyright notice and this permission notice shall be
          included in<br>
          all copies or substantial portions of the Software.</p>
        <p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
          EXPRESS OR<br>
          IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
          MERCHANTABILITY,<br>
          FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT
          SHALL THE<br>
          AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER<br>
          LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
          ARISING FROM,<br>
          OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
          IN<br>
          THE SOFTWARE.</p>
      </div>
    </div>
    <p><br>
      <br>
    </p>
    <p><br>
      <br>
    </p>
    <h3 class="western">Technische Infos</h3>
    <p>Die WebApp kommuniziert mit dem server (Stand heute) „read only“ - d.h.
      sie liest nur Daten, verändert aber keine Daten auf dem Server. Das Setzen
      des Markers ist somit eine rein lokale Sache, wenn man auf einem
      Display-Gerät den Marker setzt, beeinflusst das nicht die Anzeige auf den
      anderen Geräten. Das wird sich in zukünftigen Versionen ändern.</p>
    <p>Sie besteht aus einem HTML Gerüst (avnav_viewer.html) sowie den
      eingebundenen JavaScript Bibliotheken und einem JavaScript Anteil
      (avnav_viewer.js). Die Darstellung ist weitgehend von der eigentlichen
      Funktion entkoppelt und wird per css (unter Nutzung von less) gesteuert.
      Man kann die Darstellung in der HTMl Datei und in avnav_viewer.less
      weitgehend anpassen.</p>
    <p>Die Kommunikation erfolgt durch einfache GET requests zur url <a href="http://avnav/viewer/avnav_navi.php">http://avnav/viewer/avnav_navi.php</a>,
      dann folgen Parameter, die den request beschreiben. Die Antworten vom
      server sind json kodiert.</p>
    <p>Die wichtigsten requests sind:</p>
    <ul>
      <li>
        <p>gps: Abfrage der Positionsdaten </p>
      </li>
      <li>
        <p>ais: Abfrage der AIS Daten </p>
      </li>
      <li>
        <p>track: Abfrage des aktuellen Tracks</p>
      </li>
    </ul>
    <p>Diese Requests werden periodisch wiederholt (polling).</p>
    <p>Viele Parameter lassen sich in der Variable properties am Anfang der Java
      Script Datei einstellen.</p>
  </body>
</html>
